\section{Non-Experimental Fuzzing Campaigns:  Bugs Reported}
\label{real-world}

\begin{table}
\centering
\begin{tabular}{lrr|rrr}
\toprule
                    \bf Project       & \bf Length & \bf Total                        & \cmark            & \clock                  & \acirc                 \\
\midrule
                    Solidity          & 20mo 30d      & \solUniqueFixedOrConfirmed      & \solUniqueFixed   & \solUniqueConfirmed     & \solAValidDuplicates   \\
                                      % Fuzz: about a week Reports: Jan 27 to Feb 9 2021.
                    Move              & 20d        & \movUniqueFixedOrConfirmed       & \movUniqueFixed   & \movUniqueConfirmed     & 0                      \\
                                                                                                                                    % 63 submittd, 49 are fixed or confirmed, are the other 14 wrong or dups?
                    Fe                & 9mo 6d      & \feUniqueFixedOrConfirmed        & \feUniqueFixed    & \feUniqueConfirmed      & 6      \\
                                      % Fuzz: about a week. Reports: 1 day
                    Zig               & 7d         & \zigUniqueFixedOrConfirmed       & 0                 & \zigUniqueConfirmed     & 0                      \\
\midrule
                    All               & ???        & \allUniqueFixedOrConfirmed       & \allUniqueFixed   & \allUniqueConfirmed     & \solAValidDuplicates    \\
\bottomrule
\end{tabular}
\caption{Fuzzing campaign results for real world bugs.
Table shows all reported bugs to project's upstream issue
tracker and status.  \cmark~is \textbf{fixed} bugs. \clock~is \textbf{confirmed but unfixed bugs}. 
\acirc~is \textbf{duplicate bug reports} (either reported
duplicatively by us or another contributor).
% \xmark~is \textbf{invalid} bug reports (deemed not a real bug, i.e., WONTFIX). 
\textbf{Total} is the number of true, unique bugs reported and acknowledged by maintainers (\cmark~Fixed + \clock~Unfixed bugs).
}
\label{tab:campaign-fixes}
\end{table}

\begin{table*}
\centering
\begin{tabular}{lcll}
\toprule
                    \bf Project       & \bf Bug kind                  & \bf Ref                                                                                                         & \bf Time to fix   \\ 
\midrule                               
                    \mr{2}{Solidity}  &                               &                                                                                                                 &                   \\
                                      &                               &                                                                                                                 &                   \\
\cmidrule{2-4}                               
                    \mr{3}{Move}      & incorrect struct type arity   & \href{https://github.com/diem/diem/pull/7401}{\#7401}                                                           & 1d                \\
                                      & broken ref type constraint    & \href{https://github.com/diem/diem/pull/7613/commits/9af7ababb42c2d580869c4e697aa2321bc27bb98}{\#7613}          & 1d                \\
                                      & ...                           &                                                                                                                 &                   \\
\cmidrule{2-4}                               
                    \mr{2}{Fe}        &                               &                                                                                                                 &                   \\
                                      &                               &                                                                                                                 &                   \\
\bottomrule
\end{tabular}
\caption{Detailed bug exemplars. \textbf{Time to fix} is the time taken from report to fix being merged.}
\label{tab:bug-breakdown}
\end{table*}

In addition to our controlled experiments fuzzing a version of each compiler before we reported any bugs, we ran real fuzzing campaigns, updating the compiler versions as new commits were made, and adjusting our corpus to include new tests, of various durations, on each compiler.  Two of these campaigns are ongoing (for Solidity and Fe) and have been well-supported and well-received by the compiler teams.

\begin{sloppypar}
  Perhaps the most important evidence of the effectiveness of this approach is that we applied it to fuzzing the Solidity compiler for over a year, and in that time reported a large number of otherwise unreported bugs that have been fixed; we submitted our most recent bug (as of this writing) on 11/2/21.  Prior to and during our campaign, Solidity had been fuzzed heavily using AFL, using a dictionary, by the developers and by external contributors, and has been on oss-fuzz since the first quarter of 2019 (\url{https://blog.soliditylang.org/2021/02/10/an-introduction-to-soliditys-fuzz-testing-approach/}).  While no grammar-based approach has been applied to Solidity as a whole, the Yul IL has been fuzzed using Google's libprotobug-mutator library (\url{https://github.com/google/libprotobuf-mutator}).  Despite competing with these efforts, and never devoting more resources to the fuzzing than 3-4 docker container hosted instances of our fuzzing tool, running on a high-end laptop, we believe that our campaign was the largest single source of fuzzing-discovered bugs in the compiler during our campaign.  The campaign was awarded a security bounty of \$1,000 USD in Ethereum for discovery of a bug with potential security implications (and, it was noted, for the general effectiveness of the fuzzing), and the Solidity team encouraged and aided our efforts, once it was clear that the approach was very useful in exposing subtle bugs not otherwise discovered.  Because Solidity bug triage is very well supported, we can add an additional measure of the effectiveness of our approach in finding bugs that involve ``realistic'' code.  After October of 2020, the Solidity team began adding a ``should compile without error'' label to submitted bugs that involved legal code the compiler rejects.  Of the 38 bugs we submitted since that date, 15 (nearly 40\%) have involved correct but rejected code.  Such bugs are inherently harder to find and more interesting than the case where a fuzzer finds a case where a compiler crashes when given invalid code, rather than reporting an error message.
\end{sloppypar}

A second long-term fuzzing effort was directed at the Fe language, a Rust/Python-like alternative to Solidity for writing Ethereum contracts.  Fe is an experimental language, and the project has far fewer resources than Solidity to devote to testing.  Fe developers received this effort warmly, and quickly made some changes to the Fe compiler to make AFL fuzzing more effective (by crashing when Fe caused the Yul backend to fail).  Using our approach, we were able to provide the project with high-quality fuzzing very early in the lifetime of an experimental compiler project.  We speculate that better ``no-fuss'' fuzzing could expose language corner cases early in the implementation of a compiler, avoiding having to make costly changes later, when more code depends on erroneous implementation assumptions or (even more disastrously) poor language design choices.  Due to the small size of the Fe team, 8 of our reported bugs have not been analyzed yet and confirmed as valid.  The most recent of these was submitted (as of this writing) on 9/25/21.  The Fe effort was sufficiently influential that it was heavily invoked (and our advice solicited) in discussions of the long-term strategies for building language-customized fuzzing for Fe.

At the time we fuzzed Facebook's \texttt{Move} compiler, the project had been fuzzing various components, but less so the compiler itself.
The majority of bugs reported in the \texttt{Move} compiler were quickly confirmed and fixed, and developers expressed interest in incorporating our approach into their fuzzing CI.\footnote{Link to public dialog omitted for anonymity.}  % link: https://github.com/diem/diem/issues/7384#issuecomment-769443728


We ran a shorter, less-intensive campaign on the \texttt{Zig} compiler.  The
\texttt{Zig} compiler continues to be under heavy development, and a small team
of maintainers are prioritizing efforts to rewrite the components where we found
bugs.
